/* jQuery Youtube Channel Player 0.2.0
 * Author: Marc LÃ¶he <marc@marcloehe.de>
 * Licensed under the MIT license.
 */
!function(e){"use strict";e.fn.ytChanPlayer=function(t){var a,n=e(this),s=e("<ul/>",{"class":"yt-channel-list"}),i=e.extend({},{apiKey:"",username:"",maxResults:10,debug:!1,playerOpts:{autohide:1,autoplay:0,fs:1,showinfo:0}},t),l=!1,r=[],o=function(t){var a="http://www.youtube.com/embed/"+t;return i.playerOpts&&(a+="?"+e.param(i.playerOpts)),a},p=function(t){t.length>0&&(a||(a=e("<iframe/>",{"class":"yt-player"}).prependTo(n)),a.attr("src",o(t)),l=!0)},u=function(t){var a,n;a=e("<li/>",{"class":"yt-channel-video"}),n=e("<a/>",{href:t.embedUrl,title:t.title,target:"_blank","data-id":t.videoId}).appendTo(a),e("<img/>",{"class":"vid-thumb",alt:t.title,src:t.thumbnail}).appendTo(n),a.appendTo(s),r.push(t)},d=function(e){for(var t=Array.prototype.slice.call(arguments,1),a=0;a<t.length;a++){if(!e||!e.hasOwnProperty(t[a]))return!1;e=e[t[a]]}return!0};return n.addClass("yt-channel-holder"),s.on("click",".yt-channel-video a",function(t){t.preventDefault(),i.playerOpts=e.extend(i.playerOpts,{autoplay:1}),p(e(this).data("id"))}).appendTo(n),e.get("https://www.googleapis.com/youtube/v3/channels",{part:"contentDetails",key:i.apiKey,forUsername:i.username}).then(function(t,a,n){var s;return t.items&&t.items[0]&&d(t.items[0],"contentDetails","relatedPlaylists","uploads")?(s={part:"snippet",key:i.apiKey,playlistId:t.items[0].contentDetails.relatedPlaylists.uploads,maxResults:i.maxResults},e.get("https://www.googleapis.com/youtube/v3/playlistItems",s)):e.Deferred().reject(t,"Unable to fetch playlist items.",n).promise()}).then(function(t,a,n){return t.items&&t.items.length?void e.each(t.items,function(e,t){var a;return d(t,"snippet","resourceId","videoId")?(a={videoId:t.snippet.resourceId.videoId,title:t.snippet.title,thumbnail:t.snippet.thumbnails["default"].url},a.embedUrl=o(a.id),l||p(i.sticky||t.snippet.resourceId.videoId),void u(a)):!0}):e.Deferred().reject(t,"Unable to fetch playlist items.",n).promise()}).fail(function(e,t,a){i.debug&&console.log("Error: "+t)}),this}}(jQuery);